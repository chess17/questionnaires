"use strict";var injector=function(){var t={};return{resolve:function e(n){if("function"===$.type(n))try{return new n}catch(t){return n}else{if("array"===$.type(n)&&"function"===$.type(n[n.length-1])){var r=n.slice(0,-1).map(e),o=n[n.length-1];return o.apply(o,r)}if("string"!==$.type(n))return n;var i=t[n];if(i)return e(i)}},expose:function(e,n){t[e]=n}}}(),resolve=injector.resolve,expose=injector.expose;expose("address",["window",function(t){function e(){}return e.prototype.path=function(){return t.location.pathname},e.prototype.pathParts=function(){return this.path().split("/")},e}]),expose("document",document),expose("window",window),expose("fetch",fetch),expose("hiddenToggle",["document",function(t){function e(t){this._id=t}e.prototype.hide=function(){n(this._id,!0)},e.prototype.show=function(){n(this._id,!1)};function n(e,n){var r=t.getElementById(e);r&&(r.hidden=n)}return e}]),expose("http",["fetch",function(t){function e(t){this._opts=t||{}}return e.prototype.get=function(e){var n=$.extend(!0,{},this._opts);return n.method="GET",t(e,n)},e.prototype.getJson=function(t){var e=".json"===t.substring(t.length-5)?t:t+".json";return this.get(e).then(function(t){if(t.ok)return t.json();throw new Error("Bad response "+t.status)})},e}]);function _toConsumableArray(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}expose("table",["document",function(t){function e(t,e){this._id=t,this._opts=e}e.prototype.bind=function(t,e){this.data=t},e.prototype.render=function(){var e=t.getElementById(this._id);if(e){var n=function(t){if(t.horizontal)return"";return"<thead><tr>"+t.cols.map(function(t){return"<th>"+t.title+"</th>"}).join("")+"</tr></thead>"}(this._opts),r=function(t,e){return"<tbody>"+(t.horizontal?t.cols.map((n=e,function(t){var e=["<td>"+t.title+"</td>"].concat(_toConsumableArray(n.map(function(e){var n=e[t.key];return t.format=t.format||function(t,e){return t},"<td>"+t.format(n,e)+"</td>"}))).join("");return"<tr>"+e+"</tr>"})):e.map(function(e){return"<tr>"+t.cols.map(function(t){var n=e[t.key];t.format=t.format||function(t,e){return t};return"<td>"+t.format(n,e)+"</td>"}).join("")+"</tr>"})).join("")+"</tbody>";var n}(this._opts,this.data),o=(this._opts,i=n,a=r,'<div class="table-wrapper"><table>'+i+a+"</table></div>");e.innerHTML=o}var i,a},e.linkFormat=function(t){return function(e,n){return'<a href="'+e+'" '+(t.target?'target="'+t.target+'"':"")+">"+e+"</a>"}},e.propertyFormat=function(t){return function(e,n){return e[t]}},e.listFormat=function(t,e){return function(n,r){var o=e.property?n[e.property]:n,i=e.generateLi||function(){return"<li>"},a=e.generateUl||function(){return"<ul>"},u=o.map(function(e){return""+i(e)+t(e)+"</li>"}).join("");return""+a()+u+"</ul>"}};return e}]),expose("text",["document",function(t){function e(t){this.id=t}return e.prototype.render=function(e){var n=t.getElementById(this.id);n&&(n.textContent=e)},e}]),resolve(["http","address","table","hiddenToggle","text",function(t,e,n,r,o){var i=new r("spinner"),a=new n("questionnaireTable",{cols:[{title:"Question",key:"text"},{title:"Left score",key:"left",format:d},{title:"Right score",key:"right",format:d},{title:"Categories",key:"categories"}]}),u=new r("questionnaireTable"),s=new n("detailTable",{cols:[{title:"PDF Link",key:"pdfLink",format:n.linkFormat({target:"_blank"})},{title:"Sectors",key:"sectors"},{title:"Demographic",key:"demographic"},{title:"Scoring",key:"scoring",format:n.propertyFormat("aggregation")},{title:"Scoring bands",key:"scoring",format:n.listFormat(function(t){return t.minimum+" - "+t.maximum+": "+t.label},{generateUl:function(){return'<ul class="alt">'},property:"bands"})}],horizontal:!0}),c=new r("detailTable"),f=new o("title"),l=new o("subtitle"),p=new r("subtitle");function d(t,e){return t.label+" ("+t.score+")"}var h=function(){var t=(new e).pathParts();return t[t.length-1]}();(new t).getJson("/api/questionnaire/"+h).then(function(t){a.bind(t.questions),a.render(),s.bind([t]),s.render(),f.render(t.name),l.render(t.description),i.hide(),u.show(),c.show(),p.show()})}]);
//# sourceMappingURL=questionnaire.js.map
